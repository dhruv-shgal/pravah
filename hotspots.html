<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PRAVAH • Biodiversity Hotspots in India</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --bg: #f7faf9; --card: #ffffff; --text: #1f2b2a; --muted:#5c6e6b;
            --primary: #2d8659; --primary-dark:#1b5e42; --border:#e3e8e7; --subtle:#e8f3ef;
        }
        [data-theme="dark"] {
            --bg: #0a1f14; --card: #0f2a1d; --text:#e8f5e9; --muted:#b9d4c7; --border:#214a38; --subtle:#174734;
            --primary:#6ec99d; --primary-dark:#52c093;
        }
        html, body { height:100%; }
        body { font-family: 'Poppins', sans-serif; background:var(--bg); color:var(--text); }
        
        /* Navbar (shared) */
        .navbar { position: fixed; top:0; width:100%; background:var(--card); box-shadow:0 2px 10px rgba(0,0,0,0.05); z-index:1000; }
        .nav-container { max-width:1200px; margin:0 auto; display:flex; justify-content:space-between; align-items:center; padding: 14px 24px; }
        .logo { display:flex; align-items:center; gap:8px; font-weight:700; color:var(--primary); text-decoration:none; }
        .nav-links { display:flex; gap:20px; align-items:center; list-style:none; }
        .nav-links a { color:var(--text); text-decoration:none; font-weight:500; }
        .menu-btn { display:none; width:40px; height:40px; border:1px solid var(--border); border-radius:10px; background:var(--card); align-items:center; justify-content:center; cursor:pointer; }
        .menu-icon { width:18px; height:2px; background: var(--text); position:relative; }
        .menu-icon::before, .menu-icon::after { content:""; position:absolute; left:0; width:100%; height:2px; background: var(--text); }
        .menu-icon::before { top:-6px; }
        .menu-icon::after { top:6px; }
        .nav-links a:hover { color:var(--primary); }
        .toggle-switch { position:relative; width:50px; height:26px; background:var(--muted); border-radius:30px; cursor:pointer; }
        .toggle-slider { position:absolute; top:3px; left:3px; width:20px; height:20px; background:#fff; border-radius:50%; transition: transform .25s ease; }
        .toggle-switch.active { background: var(--primary); }
        .toggle-switch.active .toggle-slider { transform: translateX(24px); }

        .container { max-width: 1400px; margin: 0 auto; padding: 24px; margin-top: 80px; }
        .header { text-align: center; margin-bottom: 30px; }
        .page-title { font-size: 2.5rem; font-weight: 700; color: var(--primary); margin-bottom: 1rem; }
        .page-subtitle { font-size: 1.2rem; color: var(--muted); max-width: 800px; margin: 0 auto; }
        
        .map-container { 
            background: var(--card); 
            border-radius: 16px; 
            box-shadow: 0 4px 20px rgba(0,0,0,0.08); 
            padding: 20px; 
            margin-bottom: 30px;
            border: 1px solid var(--border);
        }
        
        .map-header { 
            display: flex; 
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px; 
        }
        
        .map-title { 
            font-size: 1.5rem; 
            font-weight: 600; 
            color: var(--text); 
        }
        
        .search-section {
            display: flex;
            justify-content: center;
            width: 100%;
        }
        
        .species-search {
            display: flex;
            align-items: center;
            gap: 12px;
            background: var(--subtle);
            padding: 12px 16px;
            border-radius: 12px;
            border: 1px solid var(--border);
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .search-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .species-search label {
            font-weight: 600;
            color: var(--text);
            font-size: 14px;
        }
        
        .category-select, .species-select {
            min-width: 200px;
            padding: 8px 12px;
            border: 1px solid var(--border);
            border-radius: 8px;
            background: var(--card);
            color: var(--text);
            font-size: 14px;
            outline: none;
        }
        
        .species-select {
            min-width: 300px;
        }
        
        .species-select:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(45, 134, 89, 0.1);
        }
        
        .clear-btn {
            padding: 8px 16px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s ease;
        }
        
        .clear-btn:hover {
            background: var(--primary-dark);
        }
        
        .legend-container {
            margin-bottom: 15px;
        }
        
        .legend { 
            display: flex; 
            gap: 20px; 
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .map-grayscale {
            filter: grayscale(60%) brightness(0.8) contrast(1.2);
            transition: filter 0.3s ease;
        }
        
        .legend-item { 
            display: flex; 
            align-items: center; 
            gap: 8px; 
            font-size: 14px; 
        }
        
        .legend-color { 
            width: 20px; 
            height: 20px; 
            border-radius: 4px; 
        }
        
        #map { 
            height: 600px; 
            width: 100%; 
            border-radius: 12px; 
            border: 2px solid var(--border);
            cursor: grab;
        }
        
        #map:active {
            cursor: grabbing;
        }
        
        .map-controls-info {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background: rgba(255, 255, 255, 0.9);
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            color: var(--muted);
            z-index: 1000;
            border: 1px solid var(--border);
        }
        
        [data-theme="dark"] .map-controls-info {
            background: rgba(15, 42, 29, 0.9);
            color: var(--text);
        }
        
        .hotspots-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); 
            gap: 20px; 
            margin-top: 30px; 
        }
        
        .hotspot-card { 
            background: var(--card); 
            border-radius: 12px; 
            padding: 20px; 
            box-shadow: 0 2px 12px rgba(0,0,0,0.06); 
            border: 1px solid var(--border);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        
        .hotspot-card:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 4px 20px rgba(45, 134, 89, 0.15); 
        }
        
        .hotspot-name { 
            font-size: 1.3rem; 
            font-weight: 600; 
            color: var(--primary); 
            margin-bottom: 8px; 
        }
        
        .hotspot-location { 
            color: var(--muted); 
            font-size: 14px; 
            margin-bottom: 12px; 
        }
        
        .hotspot-description { 
            line-height: 1.6; 
            margin-bottom: 15px; 
        }
        
        .hotspot-stats { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 10px; 
            margin-top: 15px; 
        }
        
        .stat { 
            text-align: center; 
            padding: 10px; 
            background: var(--subtle); 
            border-radius: 8px; 
        }
        
        .stat-number { 
            font-size: 1.5rem; 
            font-weight: 700; 
            color: var(--primary); 
        }
        
        .stat-label { 
            font-size: 12px; 
            color: var(--muted); 
            margin-top: 4px; 
        }

        .back-link { 
            display: inline-flex; 
            align-items: center; 
            gap: 8px; 
            color: var(--primary); 
            text-decoration: none; 
            font-weight: 600; 
            margin-bottom: 20px;
            transition: color 0.2s ease;
        }
        
        .back-link:hover { 
            color: var(--primary-dark); 
        }

        @media (max-width: 768px) {
            .container { padding: 16px; margin-top: 72px; }
            .nav-links { position:absolute; top:64px; right:16px; left:16px; background:var(--card); border:1px solid var(--border); box-shadow:0 10px 30px rgba(0,0,0,0.08); border-radius:14px; padding:12px; display:none; flex-direction:column; gap:10px; z-index:1001; }
            .nav-links.show { display:flex; }
            .menu-btn { display:inline-flex; }
            .page-title { font-size: 2rem; }
            .species-search { 
                flex-direction: column; 
                gap: 12px; 
                text-align: center;
            }
            .search-group {
                flex-direction: column;
                gap: 6px;
                width: 100%;
            }
            .category-select, .species-select { 
                min-width: 250px; 
                width: 100%;
            }
            .legend { 
                flex-direction: column; 
                gap: 10px; 
            }
            #map { height: 400px; }
            .hotspots-grid { grid-template-columns: 1fr; }
        }

        @media (max-width: 480px) {
            .category-select, .species-select { 
                min-width: 200px; 
                font-size: 13px;
            }
            .species-search {
                padding: 10px 12px;
            }
            .search-group {
                gap: 4px;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <a href="/" class="logo"><span>🌿</span><span>PRAVAH</span></a>
            <button class="menu-btn" id="menuBtn"><span class="menu-icon"></span></button>
            <ul class="nav-links" id="mobileMenu">
                <li><a href="/">Home</a></li>
                <li><a href="/dashboard">Dashboard</a></li>
                <li><a href="/eco-connect">Eco-Connect</a></li>
                <li><a href="/#about">About</a></li>
                <li><a href="/#contact">Contact</a></li>
                <li class="toggle-container"><div class="toggle-switch" id="darkToggle"><div class="toggle-slider"></div></div></li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <a href="index.html" class="back-link">← Back to Home</a>
        
        <div class="header">
            <h1 class="page-title">Threatened Species Hotspots in India</h1>
            <p class="page-subtitle">
                Locate critically endangered and vulnerable species across India's biodiversity hotspots. 
                These species require immediate conservation action to prevent extinction.
            </p>
            <div style="background: var(--subtle); padding: 15px; border-radius: 10px; margin-top: 20px; font-size: 14px; line-height: 1.5;">
                <strong>Zone Types Explained:</strong><br>
                🔴 <strong>Global Biodiversity Hotspots:</strong> Internationally recognized areas with exceptional species diversity and high threat levels<br>
                🟠 <strong>Freshwater Biodiversity Zones:</strong> River systems and wetlands critical for aquatic species survival<br>
                🟢 <strong>Marine Protected Ecosystems:</strong> Coastal and island areas with unique marine and terrestrial species
            </div>
        </div>

        <div class="map-container">
            <div class="map-header">
                <h2 class="map-title">Interactive Hotspots Map</h2>
                <div class="search-section">
                    <div class="species-search">
                        <div class="search-group">
                            <label for="categorySelect">Category:</label>
                            <select id="categorySelect" class="category-select">
                                <option value="">All Species</option>
                                <option value="wildlife">Wildlife</option>
                                <option value="aquatic">Aquatic</option>
                            </select>
                        </div>
                        <div class="search-group">
                            <label for="speciesSearch">Species:</label>
                            <select id="speciesSearch" class="species-select">
                                <option value="">Select a species to locate...</option>
                            </select>
                        </div>
                        <button id="clearSearch" class="clear-btn">Clear</button>
                    </div>
                </div>
            </div>
            <div class="legend-container">
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background: rgba(255, 107, 53, 0.7);"></div>
                        <span>Global Biodiversity Hotspots</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: rgba(247, 147, 30, 0.7);"></div>
                        <span>Freshwater Biodiversity Zones</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: rgba(139, 195, 74, 0.7);"></div>
                        <span>Marine Protected Ecosystems</span>
                    </div>
                    <div class="legend-item" id="speciesLegend" style="display: none;">
                        <div class="legend-color" style="background: #ff5722; border: 2px solid #ff1744;"></div>
                        <span>Threatened Species Habitat</span>
                    </div>
                </div>
                <div class="legend" style="margin-top: 10px; font-size: 12px;">
                    <div class="legend-item">
                        <span>🔴 Critically Endangered</span>
                    </div>
                    <div class="legend-item">
                        <span>🟠 Endangered</span>
                    </div>
                    <div class="legend-item">
                        <span>🟡 Vulnerable</span>
                    </div>
                </div>
            </div>
            <div id="map">
                <div class="map-controls-info">
                    🖱️ Drag to pan • 🔍 Scroll to zoom • 📍 Click markers for info
                </div>
            </div>
        </div>

        <div class="hotspots-grid">
            <div class="hotspot-card">
                <div class="hotspot-name">Western Ghats</div>
                <div class="hotspot-location">Kerala, Karnataka, Tamil Nadu, Maharashtra, Goa</div>
                <div class="hotspot-description">
                    One of the world's eight "hottest hotspots" of biological diversity. The Western Ghats are home to 
                    thousands of endemic species and are crucial for India's monsoon patterns.
                </div>
                <div class="hotspot-stats">
                    <div class="stat">
                        <div class="stat-number">7,402</div>
                        <div class="stat-label">Endemic Species</div>
                    </div>
                    <div class="stat">
                        <div class="stat-number">325</div>
                        <div class="stat-label">Threatened Species</div>
                    </div>
                </div>
            </div>

            <div class="hotspot-card">
                <div class="hotspot-name">Eastern Himalayas</div>
                <div class="hotspot-location">Sikkim, Darjeeling, Arunachal Pradesh, Assam</div>
                <div class="hotspot-description">
                    A global biodiversity hotspot spanning across the Himalayan range, known for its unique alpine 
                    ecosystems and endangered species like the Red Panda and Snow Leopard.
                </div>
                <div class="hotspot-stats">
                    <div class="stat">
                        <div class="stat-number">3,500</div>
                        <div class="stat-label">Endemic Species</div>
                    </div>
                    <div class="stat">
                        <div class="stat-number">163</div>
                        <div class="stat-label">Threatened Species</div>
                    </div>
                </div>
            </div>

            <div class="hotspot-card">
                <div class="hotspot-name">Indo-Burma Region</div>
                <div class="hotspot-location">Northeast India, Myanmar Border</div>
                <div class="hotspot-description">
                    This hotspot includes parts of Northeast India and is known for its exceptional freshwater 
                    biodiversity and unique species found nowhere else on Earth.
                </div>
                <div class="hotspot-stats">
                    <div class="stat">
                        <div class="stat-number">2,100</div>
                        <div class="stat-label">Endemic Species</div>
                    </div>
                    <div class="stat">
                        <div class="stat-number">140</div>
                        <div class="stat-label">Threatened Species</div>
                    </div>
                </div>
            </div>

            <div class="hotspot-card">
                <div class="hotspot-name">Sundaland Extension</div>
                <div class="hotspot-location">Andaman & Nicobar Islands</div>
                <div class="hotspot-description">
                    The Andaman and Nicobar Islands represent a unique marine and terrestrial ecosystem with high 
                    levels of endemism, especially among marine species.
                </div>
                <div class="hotspot-stats">
                    <div class="stat">
                        <div class="stat-number">1,800</div>
                        <div class="stat-label">Endemic Species</div>
                    </div>
                    <div class="stat">
                        <div class="stat-label">Marine Biodiversity</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Theme management
        (function(){
            const html = document.documentElement;
            const saved = localStorage.getItem('theme') || 'light';
            html.setAttribute('data-theme', saved);
            const t = document.getElementById('darkToggle');
            if (saved === 'dark') t.classList.add('active');
            t.addEventListener('click', function(){
                const cur = html.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
                html.setAttribute('data-theme', cur); localStorage.setItem('theme', cur); this.classList.toggle('active');
            });
            // Mobile menu
            const menuBtn = document.getElementById('menuBtn');
            const mobileMenu = document.getElementById('mobileMenu');
            menuBtn.addEventListener('click', function(){ mobileMenu.classList.toggle('show'); });
        })();

        // Initialize map with proper controls
        const map = L.map('map', {
            center: [20.5937, 78.9629],
            zoom: 5,
            zoomControl: true,
            scrollWheelZoom: true,
            doubleClickZoom: true,
            boxZoom: true,
            keyboard: true,
            dragging: true,
            touchZoom: true
        });

        // Add tile layer
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '© OpenStreetMap contributors',
            maxZoom: 18,
            minZoom: 4
        }).addTo(map);

        // Biodiversity hotspots data for India
        const hotspots = [
            {
                name: "Western Ghats",
                coords: [
                    [8.0883, 77.0419], [8.5, 76.8], [9.2, 76.5], [10.1, 76.2], [11.0, 76.0],
                    [12.5, 75.8], [14.2, 75.5], [15.8, 74.8], [17.5, 74.2], [19.2, 73.8],
                    [20.5, 73.5], [21.0, 73.0], [20.8, 74.2], [19.5, 75.1], [18.2, 75.8],
                    [16.8, 76.2], [15.2, 76.8], [13.5, 77.2], [11.8, 77.5], [10.2, 77.8],
                    [8.8, 77.6], [8.0883, 77.0419]
                ],
                center: [15.2993, 74.1240],
                type: "critical",
                description: "UNESCO World Heritage Site - One of 36 global biodiversity hotspots with 70% habitat loss",
                species: 7402,
                threatened: 325
            },
            {
                name: "Eastern Himalayas",
                coords: [
                    [26.5, 88.0], [27.2, 88.5], [27.8, 89.2], [28.2, 90.1], [28.5, 91.0],
                    [28.7, 92.2], [28.9, 93.5], [29.0, 94.8], [28.8, 95.5], [28.5, 96.2],
                    [28.0, 96.8], [27.2, 97.2], [26.8, 96.5], [26.5, 95.8], [26.2, 94.5],
                    [26.0, 93.2], [25.8, 91.8], [25.9, 90.5], [26.2, 89.2], [26.5, 88.0]
                ],
                center: [27.7172, 92.3639],
                type: "critical",
                description: "Global biodiversity hotspot - High altitude ecosystems with endemic species",
                species: 3500,
                threatened: 163
            },
            {
                name: "Indo-Burma (Northeast India)",
                coords: [
                    [23.5, 92.5], [24.2, 92.8], [25.0, 93.5], [25.8, 94.2], [26.5, 95.0],
                    [27.0, 96.2], [27.2, 97.5], [26.8, 98.0], [26.2, 97.8], [25.5, 97.2],
                    [24.8, 96.5], [24.0, 95.8], [23.5, 94.8], [23.2, 93.5], [23.5, 92.5]
                ],
                center: [25.2788, 95.1213],
                type: "freshwater",
                description: "Freshwater biodiversity hotspot - Rivers, wetlands & aquatic species diversity",
                species: 2100,
                threatened: 140
            },
            {
                name: "Andaman & Nicobar Islands",
                coords: [
                    [6.4627, 92.7191], [7.5, 92.8], [8.8, 92.9], [10.2, 93.0], [11.5, 93.1],
                    [12.8, 93.2], [13.8373, 93.0064], [13.5, 92.8], [12.2, 92.7], [10.8, 92.6],
                    [9.2, 92.5], [7.8, 92.6], [6.4627, 92.7191]
                ],
                center: [11.7401, 92.6586],
                type: "marine",
                description: "Marine protected ecosystem - Coral reefs, mangroves & island endemism",
                species: 1800,
                threatened: 95
            }
        ];

        // Color mapping for different hotspot types
        const colors = {
            critical: 'rgba(255, 107, 53, 0.7)',    // Red-orange for global hotspots
            freshwater: 'rgba(247, 147, 30, 0.7)',  // Orange for freshwater zones
            marine: 'rgba(139, 195, 74, 0.7)'       // Green for marine ecosystems
        };

        // Add hotspots to map
        hotspots.forEach(hotspot => {
            // Create polygon for hotspot area with better visibility
            const polygon = L.polygon(hotspot.coords, {
                color: colors[hotspot.type].replace('0.7', '1'), // Solid border
                fillColor: colors[hotspot.type],
                fillOpacity: 0.6, // Increased opacity
                weight: 3, // Thicker border
                opacity: 1
            }).addTo(map);

            // Add marker at center with custom icon
            const marker = L.circleMarker(hotspot.center, {
                radius: 10,
                fillColor: colors[hotspot.type].replace('0.7', '1'),
                color: '#ffffff',
                weight: 2,
                opacity: 1,
                fillOpacity: 0.9
            }).addTo(map);
            
            // Create popup content
            const popupContent = `
                <div style="font-family: 'Poppins', sans-serif; max-width: 250px;">
                    <h3 style="color: #2d8659; margin-bottom: 8px; font-size: 16px;">${hotspot.name}</h3>
                    <p style="margin-bottom: 10px; font-size: 14px; line-height: 1.4;">${hotspot.description}</p>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-top: 10px;">
                        <div style="text-align: center; padding: 8px; background: #e8f3ef; border-radius: 6px;">
                            <div style="font-weight: 700; color: #2d8659; font-size: 18px;">${hotspot.species}</div>
                            <div style="font-size: 11px; color: #5c6e6b;">Endemic Species</div>
                        </div>
                        <div style="text-align: center; padding: 8px; background: #e8f3ef; border-radius: 6px;">
                            <div style="font-weight: 700; color: #2d8659; font-size: 18px;">${hotspot.threatened}</div>
                            <div style="font-size: 11px; color: #5c6e6b;">Threatened</div>
                        </div>
                    </div>
                </div>
            `;
            
            marker.bindPopup(popupContent);
            polygon.bindPopup(popupContent);
        });

        // Critically Endangered and Vulnerable Species Data
        const allSpeciesHabitats = {
            wildlife: [
                {
                    name: "Bengal Tiger",
                    category: "wildlife",
                    status: "Endangered",
                    coords: [
                        [26.5775, 93.1714], // Kaziranga
                        [21.9497, 88.4297], // Sundarbans
                        [11.6854, 76.6847], // Bandipur
                        [9.4981, 77.1025],  // Periyar
                        [29.5319, 79.1963], // Jim Corbett
                    ],
                    region: [[21.0, 70.0], [30.0, 95.0], [28.0, 98.0], [20.0, 85.0], [21.0, 70.0]],
                    hotspot: "Multiple Hotspots",
                    description: "Endangered: ~2,500 individuals remain in India"
                },
                {
                    name: "Asiatic Lion",
                    category: "wildlife",
                    status: "Endangered",
                    coords: [[21.1248, 70.7871]], // Gir Forest
                    region: [[20.5, 70.0], [22.0, 70.0], [22.0, 71.5], [20.5, 71.5], [20.5, 70.0]],
                    hotspot: "Western Ghats",
                    description: "Endangered: Only ~650 individuals in Gir Forest"
                },
                {
                    name: "Snow Leopard",
                    category: "wildlife",
                    status: "Vulnerable",
                    coords: [
                        [32.2431, 78.0419], // Ladakh
                        [31.1048, 77.1734], // Himachal Pradesh
                        [30.0668, 79.0193], // Uttarakhand
                    ],
                    region: [[30.0, 75.0], [35.0, 75.0], [35.0, 82.0], [30.0, 82.0], [30.0, 75.0]],
                    hotspot: "Eastern Himalayas",
                    description: "Vulnerable: ~400-700 individuals in Indian Himalayas"
                },
                {
                    name: "Red Panda",
                    category: "wildlife",
                    status: "Endangered",
                    coords: [
                        [27.7172, 88.3639], // Sikkim
                        [27.2046, 93.6053], // Arunachal Pradesh
                        [25.5788, 91.8933], // Meghalaya
                    ],
                    region: [[26.5, 87.0], [28.5, 87.0], [28.5, 95.0], [26.5, 95.0], [26.5, 87.0]],
                    hotspot: "Eastern Himalayas",
                    description: "Endangered: <2,500 adults worldwide, ~800 in India"
                },
                {
                    name: "Lion-tailed Macaque",
                    category: "wildlife",
                    status: "Endangered",
                    coords: [
                        [15.2993, 74.1240], // Western Ghats
                        [11.2588, 75.7804], // Silent Valley
                        [9.4981, 77.1025],  // Periyar
                    ],
                    region: [[8.0, 73.0], [21.0, 73.0], [21.0, 77.0], [8.0, 77.0], [8.0, 73.0]],
                    hotspot: "Western Ghats",
                    description: "Endangered: ~4,000 individuals in Western Ghats"
                },
                {
                    name: "Nilgiri Tahr",
                    category: "wildlife",
                    status: "Endangered",
                    coords: [
                        [10.1632, 77.0729], // Nilgiri Hills
                        [9.4981, 77.1025],  // Periyar
                        [10.5276, 77.2315], // Mukurthi
                    ],
                    region: [[9.5, 76.5], [11.0, 76.5], [11.0, 77.5], [9.5, 77.5], [9.5, 76.5]],
                    hotspot: "Western Ghats",
                    description: "Endangered: ~3,000 individuals in Nilgiri Hills"
                },
                {
                    name: "Indian Pangolin",
                    category: "wildlife",
                    status: "Endangered",
                    coords: [
                        [15.2993, 74.1240], // Western Ghats
                        [21.2787, 81.8661], // Central India
                        [26.5775, 93.1714], // Northeast
                    ],
                    region: [[8.0, 70.0], [30.0, 95.0], [25.0, 98.0], [15.0, 85.0], [8.0, 70.0]],
                    hotspot: "Multiple Hotspots",
                    description: "Endangered: Most trafficked mammal globally"
                },
                {
                    name: "Great Indian Bustard",
                    category: "wildlife",
                    status: "Critically Endangered",
                    coords: [
                        [26.9124, 70.9083], // Rajasthan
                        [19.7515, 75.7139], // Maharashtra
                    ],
                    region: [[19.0, 70.0], [28.0, 78.0], [26.0, 80.0], [21.0, 72.0], [19.0, 70.0]],
                    hotspot: "Western Ghats",
                    description: "Critically Endangered: <200 individuals remain"
                },
                {
                    name: "Nilgiri Tahr",
                    category: "wildlife",
                    coords: [
                        [10.1632, 77.0729], // Nilgiri Hills
                        [9.4981, 77.1025],  // Periyar
                        [10.5276, 77.2315], // Mukurthi
                    ],
                    region: [[9.5, 76.5], [11.0, 76.5], [11.0, 77.5], [9.5, 77.5], [9.5, 76.5]],
                    hotspot: "Western Ghats",
                    description: "Mountain goat endemic to Nilgiri Hills and surroundings"
                },
                {
                    name: "Indian Pangolin",
                    category: "wildlife",
                    coords: [
                        [15.2993, 74.1240], // Western Ghats
                        [21.2787, 81.8661], // Central India
                        [26.5775, 93.1714], // Northeast
                    ],
                    region: [[8.0, 70.0], [30.0, 95.0], [25.0, 98.0], [15.0, 85.0], [8.0, 70.0]],
                    hotspot: "Multiple Hotspots",
                    description: "Found across various forest types in India"
                },
                {
                    name: "Sloth Bear",
                    category: "wildlife",
                    coords: [
                        [11.6854, 76.6847], // Bandipur
                        [21.1248, 70.7871], // Gir
                        [19.0760, 84.0360], // Simlipal
                    ],
                    region: [[8.0, 70.0], [25.0, 88.0], [22.0, 95.0], [15.0, 85.0], [8.0, 70.0]],
                    hotspot: "Western Ghats",
                    description: "Dry and moist deciduous forests across India"
                }
            ],
            aquatic: [
                {
                    name: "Ganges River Dolphin",
                    category: "aquatic",
                    status: "Endangered",
                    coords: [
                        [25.5941, 85.1376], // Ganges in Bihar
                        [26.8467, 80.9462], // Ganges in UP
                        [24.7136, 84.9418], // Ganges in Jharkhand
                    ],
                    region: [[24.0, 80.0], [28.0, 80.0], [28.0, 88.0], [24.0, 88.0], [24.0, 80.0]],
                    hotspot: "Indo-Burma Region",
                    description: "Endangered: ~4,000 individuals in Ganges-Brahmaputra system"
                },
                {
                    name: "Gharial",
                    category: "aquatic",
                    status: "Critically Endangered",
                    coords: [
                        [24.6637, 77.3081], // Chambal River
                        [26.8467, 80.9462], // Ganges
                        [23.2599, 77.4126], // Son River
                    ],
                    region: [[23.0, 75.0], [28.0, 82.0], [26.0, 85.0], [24.0, 80.0], [23.0, 75.0]],
                    hotspot: "Indo-Burma Region",
                    description: "Critically Endangered: <200 breeding adults remain"
                },
                {
                    name: "Olive Ridley Sea Turtle",
                    category: "aquatic",
                    status: "Vulnerable",
                    coords: [
                        [19.3149, 84.7941], // Odisha coast
                        [13.0827, 80.2707], // Tamil Nadu coast
                        [15.2993, 74.1240], // Goa coast
                    ],
                    region: [[8.0, 68.0], [22.0, 88.0], [20.0, 95.0], [12.0, 85.0], [8.0, 68.0]],
                    hotspot: "Western Ghats",
                    description: "Vulnerable: Mass nesting sites along Indian coast"
                },
                {
                    name: "Green Sea Turtle",
                    category: "aquatic",
                    status: "Endangered",
                    coords: [
                        [11.7401, 92.6586], // Andaman & Nicobar
                        [8.4875, 76.9525],  // Lakshadweep
                        [19.3149, 84.7941], // Odisha coast
                    ],
                    region: [[6.0, 68.0], [25.0, 95.0], [22.0, 98.0], [10.0, 85.0], [6.0, 68.0]],
                    hotspot: "Sundaland Extension",
                    description: "Endangered: Critical nesting beaches in islands"
                },
                {
                    name: "Hawksbill Sea Turtle",
                    category: "aquatic",
                    status: "Critically Endangered",
                    coords: [
                        [11.7401, 92.6586], // Andaman & Nicobar
                        [8.4875, 76.9525],  // Lakshadweep
                    ],
                    region: [[6.0, 68.0], [15.0, 95.0], [13.0, 98.0], [8.0, 85.0], [6.0, 68.0]],
                    hotspot: "Sundaland Extension",
                    description: "Critically Endangered: <15,000 nesting females globally"
                },
                {
                    name: "Mahseer (Humpback)",
                    category: "aquatic",
                    status: "Endangered",
                    coords: [
                        [15.2993, 74.1240], // Western Ghats rivers
                        [11.2588, 75.7804], // Cauvery River
                        [9.4981, 77.1025],  // Periyar River
                    ],
                    region: [[8.0, 73.0], [21.0, 77.0], [18.0, 80.0], [12.0, 76.0], [8.0, 73.0]],
                    hotspot: "Western Ghats",
                    description: "Endangered: Declining due to dam construction"
                },
                {
                    name: "Hilsa Fish",
                    category: "aquatic",
                    status: "Vulnerable",
                    coords: [
                        [22.5726, 88.3639], // Hooghly River
                        [21.9497, 88.4297], // Sundarbans
                        [24.7136, 84.9418], // Ganges tributaries
                    ],
                    region: [[21.0, 85.0], [26.0, 90.0], [24.0, 92.0], [22.0, 88.0], [21.0, 85.0]],
                    hotspot: "Indo-Burma Region",
                    description: "Vulnerable: Overfishing threatens migration routes"
                },

            ]
        };

        // Flatten all species for easy access
        const speciesHabitats = [...allSpeciesHabitats.wildlife, ...allSpeciesHabitats.aquatic];

        // Add additional protected areas
        const protectedAreas = [
            { name: "Kaziranga National Park", coords: [26.5775, 93.1714], description: "Home to the one-horned rhinoceros" },
            { name: "Sundarbans National Park", coords: [21.9497, 88.4297], description: "Largest mangrove forest in the world" },
            { name: "Gir National Park", coords: [21.1248, 70.7871], description: "Last refuge of the Asiatic lion" },
            { name: "Bandipur National Park", coords: [11.6854, 76.6847], description: "Tiger reserve in the Western Ghats" },
            { name: "Periyar National Park", coords: [9.4981, 77.1025], description: "Elephant and tiger sanctuary" }
        ];

        protectedAreas.forEach(area => {
            const marker = L.circleMarker(area.coords, {
                radius: 8,
                fillColor: '#52c093',
                color: '#2d8659',
                weight: 2,
                opacity: 1,
                fillOpacity: 0.8
            }).addTo(map);
            
            marker.bindPopup(`
                <div style="font-family: 'Poppins', sans-serif;">
                    <h4 style="color: #2d8659; margin-bottom: 5px;">${area.name}</h4>
                    <p style="font-size: 13px; margin: 0;">${area.description}</p>
                </div>
            `);
        });

        // Function to populate species dropdown based on category
        function populateSpeciesDropdown(category = '') {
            const speciesSelect = document.getElementById('speciesSearch');
            // Clear existing options except the first one
            speciesSelect.innerHTML = '<option value="">Select a threatened species to locate...</option>';
            
            let speciesToShow = speciesHabitats;
            if (category) {
                speciesToShow = speciesHabitats.filter(species => species.category === category);
            }
            
            speciesToShow.forEach(species => {
                const option = document.createElement('option');
                option.value = species.name;
                const statusIcon = species.status === 'Critically Endangered' ? '🔴' : 
                                 species.status === 'Endangered' ? '🟠' : '🟡';
                option.textContent = `${statusIcon} ${species.name} (${species.status})`;
                speciesSelect.appendChild(option);
            });
        }

        // Initial population of species dropdown
        populateSpeciesDropdown();

        // Variables for species highlighting
        let currentSpeciesLayer = null;
        let currentSpeciesMarkers = [];
        let isGrayscale = false;

        // Function to apply grayscale filter
        function applyGrayscale() {
            if (!isGrayscale) {
                const mapContainer = document.getElementById('map');
                mapContainer.classList.add('map-grayscale');
                isGrayscale = true;
            }
        }

        // Function to remove grayscale filter
        function removeGrayscale() {
            if (isGrayscale) {
                const mapContainer = document.getElementById('map');
                mapContainer.classList.remove('map-grayscale');
                isGrayscale = false;
            }
        }

        // Function to highlight species habitat
        function highlightSpecies(speciesName) {
            // Clear previous highlights
            clearSpeciesHighlight();

            const species = speciesHabitats.find(s => s.name === speciesName);
            if (!species) return;

            // Apply grayscale to map
            applyGrayscale();

            // Show species legend
            document.getElementById('speciesLegend').style.display = 'flex';

            // Add habitat region polygon with better visibility
            if (species.region) {
                currentSpeciesLayer = L.polygon(species.region, {
                    color: '#ff1744',
                    fillColor: '#ff5722',
                    fillOpacity: 0.5,
                    weight: 4,
                    opacity: 1,
                    dashArray: '8, 4'
                }).addTo(map);

                const statusIcon = species.status === 'Critically Endangered' ? '🔴' : 
                                 species.status === 'Endangered' ? '🟠' : '🟡';
                currentSpeciesLayer.bindPopup(`
                    <div style="font-family: 'Poppins', sans-serif; max-width: 280px;">
                        <h3 style="color: #e23d3d; margin-bottom: 8px; font-size: 16px;">${statusIcon} ${species.name}</h3>
                        <div style="padding: 6px 10px; background: #fee; border-radius: 6px; margin-bottom: 10px; border-left: 3px solid #e23d3d;">
                            <strong>Status:</strong> ${species.status}
                        </div>
                        <p style="margin-bottom: 10px; font-size: 14px; line-height: 1.4;">${species.description}</p>
                        <div style="padding: 8px; background: #f0f8ff; border-radius: 6px; border-left: 3px solid #2d8659;">
                            <strong>Primary Hotspot:</strong> ${species.hotspot}
                        </div>
                    </div>
                `);
            }

            // Add species location markers with better visibility
            species.coords.forEach(coord => {
                const marker = L.circleMarker(coord, {
                    radius: 15,
                    fillColor: '#ff1744',
                    color: '#ffffff',
                    weight: 4,
                    opacity: 1,
                    fillOpacity: 1
                }).addTo(map);

                const statusIcon = species.status === 'Critically Endangered' ? '🔴' : 
                                 species.status === 'Endangered' ? '🟠' : '🟡';
                marker.bindPopup(`
                    <div style="font-family: 'Poppins', sans-serif;">
                        <h4 style="color: #e23d3d; margin-bottom: 5px;">${statusIcon} ${species.name}</h4>
                        <p style="font-size: 12px; color: #666; margin: 2px 0;">${species.status}</p>
                        <p style="font-size: 13px; margin: 0;">📍 Critical habitat location</p>
                    </div>
                `);

                currentSpeciesMarkers.push(marker);
            });

            // Fit map to species habitat
            if (species.region) {
                map.fitBounds(species.region, { padding: [20, 20] });
            } else if (species.coords.length > 0) {
                map.setView(species.coords[0], 8);
            }
        }

        // Function to clear species highlight
        function clearSpeciesHighlight() {
            // Remove species layer
            if (currentSpeciesLayer) {
                map.removeLayer(currentSpeciesLayer);
                currentSpeciesLayer = null;
            }

            // Remove species markers
            currentSpeciesMarkers.forEach(marker => {
                map.removeLayer(marker);
            });
            currentSpeciesMarkers = [];

            // Remove grayscale
            removeGrayscale();

            // Hide species legend
            document.getElementById('speciesLegend').style.display = 'none';

            // Reset map view
            map.setView([20.5937, 78.9629], 5);
        }

        // Event listeners
        const categorySelect = document.getElementById('categorySelect');
        const speciesSelect = document.getElementById('speciesSearch');
        
        // Category selection handler
        categorySelect.addEventListener('change', function() {
            const selectedCategory = this.value;
            populateSpeciesDropdown(selectedCategory);
            clearSpeciesHighlight(); // Clear any existing highlights
        });
        
        // Species selection handler
        speciesSelect.addEventListener('change', function() {
            const selectedSpecies = this.value;
            if (selectedSpecies) {
                highlightSpecies(selectedSpecies);
            } else {
                clearSpeciesHighlight();
            }
        });

        // Clear search handler
        document.getElementById('clearSearch').addEventListener('click', function() {
            categorySelect.value = '';
            speciesSelect.value = '';
            populateSpeciesDropdown(); // Reset to show all species
            clearSpeciesHighlight();
        });

        // Add map interaction feedback
        map.on('zoomstart', function() {
            const controlsInfo = document.querySelector('.map-controls-info');
            if (controlsInfo) {
                controlsInfo.style.opacity = '0.5';
            }
        });

        map.on('zoomend', function() {
            const controlsInfo = document.querySelector('.map-controls-info');
            if (controlsInfo) {
                controlsInfo.style.opacity = '1';
                const currentZoom = map.getZoom();
                if (currentZoom > 7) {
                    controlsInfo.innerHTML = '🖱️ Drag to explore • 🔍 Zoom out to see full map • 📍 Click for details';
                } else {
                    controlsInfo.innerHTML = '🖱️ Drag to pan • 🔍 Scroll to zoom • 📍 Click markers for info';
                }
            }
        });

        map.on('dragstart', function() {
            const controlsInfo = document.querySelector('.map-controls-info');
            if (controlsInfo) {
                controlsInfo.style.opacity = '0.3';
            }
        });

        map.on('dragend', function() {
            const controlsInfo = document.querySelector('.map-controls-info');
            if (controlsInfo) {
                controlsInfo.style.opacity = '1';
            }
        });
    </script>
</body>
</html>